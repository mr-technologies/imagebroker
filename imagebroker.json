{
  "IFF": {
    "log_level": "WARNING",

    "devices": [
      {
        "id": "cpu_dev",
        "type": "cpu"
      },
      {
        "id": "cuda_dev",
        "type": "cuda",
        "device_number": 0
      }
    ]
  },

  "chains": [
    {
      "id": "test_chain",

      "elements": [
        {
          "id": "cam",
          "type": "xicamera",
          "debug_level": "WARNING",
          "auto_bandwidth_calculation": false,
          "cpu_device_id": "cpu_dev",
          "serial_number": "CECAU2218000",
          "buffer_mode": "safe",
          "custom_params": [
            { "acq_buffer_size_unit": 8 },
            { "acq_buffer_size": 4816896 },
            { "buffers_queue_size": 6 },
            { "bpc": 1 },
            { "limit_bandwidth": 3000 }, //for USB3
            { "limit_bandwidth_mode": 1 }
          ],
          "roi_region": { //full frame is 2064x1544
            "offset_x": 0,
            "width": 2064,
            "offset_y": 0,
            "height": 1544
          },
          "exposure": 10000,
          "fps": 60.0,
          "gain": 0.0,
          "image_format": "RAW16"
        },
        {
          "id": "gpuproc",
          "type": "cuda_processor",
          "cpu_device_id": "cpu_dev",
          "gpu_device_id": "cuda_dev",
          "elements": [
            {"id": "import_from_host", "type": "import_from_host"},
            {"id": "black_level", "type": "black_level"},
            {"id": "white_balance", "type": "white_balance"},
            {"id": "demosaic", "type": "demosaic", "algorithm": "DFPD"},
            {"id": "color_correction", "type": "color_correction", "matrix": [ 0.035829098,   -0.74462153152,  1.70864363808,
                                                                              -0.41334634771,  1.62555457277, -0.21229019778,
                                                                               1.81950180897, -0.6574637114,  -0.1617334668]},
            {"id": "gamma", "type": "gamma8", "function": "hlg", "linear": 0.018, "power": 0.45}, //linear and power for function "gamma"
            {"id": "export_to_device", "type": "export_to_device", "output_format": "RGBA8", "output_name": "rgba"},
            {"id": "hist", "type": "histogram", "output_format": "Histogram4Bayer256Int", "output_name": "histogram"}
          ],
          "connections": [
            { "src": "import_from_host", "dst": "black_level" },
            { "src": "black_level", "dst": "white_balance" },
            { "src": "white_balance", "dst": "demosaic" },
            { "src": "demosaic", "dst": "color_correction" },
            { "src": "color_correction", "dst": "gamma" },
            { "src": "gamma", "dst": "export_to_device" },
            { "src": "black_level", "dst": "hist" }
          ]
        },
        {
          "id": "autoctrl",
          "type": "awb_aec",
          "cpu_device_id": "cpu_dev",
          "autostart": true,
          "aec_enabled": true,
          "awb_enabled": true,
          "max_exposure": 15000,
          "ev_correction": -1.585 //for HLG
        },
        {
          "id": "exporter",
          "type": "frame_exporter",
          "device_id": "cuda_dev"
        }
      ],
      "connections": [
        { "src": "cam", "dst": "gpuproc" },
        { "src": "gpuproc->histogram","dst": "autoctrl", "type": "weak" },
        { "src": "gpuproc->rgba", "dst": "exporter" }
      ],
      "parametercontrol": [
        { "origin": "autoctrl/wb_callback", "target": "cam" },
        { "origin": "autoctrl/exposure_callback", "target": "cam" }
      ]
    }
  ]
}
